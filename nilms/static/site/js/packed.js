var wget=function(url,callback){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==XMLHttpRequest.DONE){callback(xhr.responseText);}}
xhr.open('GET',url,true);xhr.send(null);};var wpost=function(url,data,callback){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==XMLHttpRequest.DONE){callback(xhr.responseText);}}
xhr.open('POST',url,true);xhr.setRequestHeader("Content-Type","application/json;charset=UTF-8");xhr.send(JSON.stringify(data));};window.addEventListener('DOMContentLoaded',function(e){if(!window.visitor)
window.editor=new MediumEditor('.editable');window.page_id=document.querySelector('input[name="page_id"]').value;window.fields=document.querySelectorAll('.editable');loadFields();});window.loadFields=function(){wget('/api/page/data/'+page_id,function(data){data=JSON.parse(data);for(var property in data){if(data.hasOwnProperty(property)){var field=document.getElementById(property);field.innerText=data[property];}}});};document.addEventListener('DOMContentLoaded',function(e){if(window.visitor)return;window.saveButton=document.getElementById('admin-save');saveButton.addEventListener('click',function(e){query={};for(var i=0;i<fields.length;i++){var field=fields[i];query[field.getAttribute('id')]=field.innerText;}
wpost('/api/page/update/'+page_id,query,function(data){console.log(data);});});});